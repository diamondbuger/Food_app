{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mitta\\\\.vscode\\\\MERN-FoodApp\\\\src\\\\components\\\\ProtectedRoute.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useEffect, useState } from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport { apiCalls } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children,\n  requiredRole = null\n}) => {\n  _s();\n  const {\n    user,\n    loading,\n    logout\n  } = useContext(AuthContext);\n  const [tokenValid, setTokenValid] = useState(null);\n  useEffect(() => {\n    const checkToken = async () => {\n      if (!user) {\n        setTokenValid(false);\n        return;\n      }\n      try {\n        await apiCalls.verifyToken();\n        setTokenValid(true);\n      } catch (err) {\n        // Token invalid, logout user\n        logout();\n        setTokenValid(false);\n      }\n    };\n    checkToken();\n  }, [user, logout]);\n  if (loading || tokenValid === null) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"loading\",\n      children: \"Verifying access...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 12\n    }, this);\n  }\n  if (!tokenValid || !user) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 12\n    }, this);\n  }\n  if (requiredRole && user.role !== requiredRole) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 12\n    }, this);\n  }\n  return children;\n};\n_s(ProtectedRoute, \"p6EEdq7O/sPkO+ZlR1sdtKwBdBI=\");\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useContext","useEffect","useState","Navigate","AuthContext","apiCalls","jsxDEV","_jsxDEV","ProtectedRoute","children","requiredRole","_s","user","loading","logout","tokenValid","setTokenValid","checkToken","verifyToken","err","className","fileName","_jsxFileName","lineNumber","columnNumber","to","role","_c","$RefreshReg$"],"sources":["C:/Users/mitta/.vscode/MERN-FoodApp/src/components/ProtectedRoute.jsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { apiCalls } from '../services/api';\r\n\r\nconst ProtectedRoute = ({ children, requiredRole = null }) => {\r\n  const { user, loading, logout } = useContext(AuthContext);\r\n  const [tokenValid, setTokenValid] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const checkToken = async () => {\r\n      if (!user) {\r\n        setTokenValid(false);\r\n        return;\r\n      }\r\n\r\n      try {\r\n        await apiCalls.verifyToken();\r\n        setTokenValid(true);\r\n      } catch (err) {\r\n        // Token invalid, logout user\r\n        logout();\r\n        setTokenValid(false);\r\n      }\r\n    };\r\n\r\n    checkToken();\r\n  }, [user, logout]);\r\n\r\n  if (loading || tokenValid === null) {\r\n    return <div className=\"loading\">Verifying access...</div>;\r\n  }\r\n\r\n  if (!tokenValid || !user) {\r\n    return <Navigate to=\"/login\" />;\r\n  }\r\n\r\n  if (requiredRole && user.role !== requiredRole) {\r\n    return <Navigate to=\"/\" />;\r\n  }\r\n\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AAC9D,SAASC,QAAQ,QAAQ,kBAAkB;AAC3C,SAASC,WAAW,QAAQ,wBAAwB;AACpD,SAASC,QAAQ,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE3C,MAAMC,cAAc,GAAGA,CAAC;EAAEC,QAAQ;EAAEC,YAAY,GAAG;AAAK,CAAC,KAAK;EAAAC,EAAA;EAC5D,MAAM;IAAEC,IAAI;IAAEC,OAAO;IAAEC;EAAO,CAAC,GAAGd,UAAU,CAACI,WAAW,CAAC;EACzD,MAAM,CAACW,UAAU,EAAEC,aAAa,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EAElDD,SAAS,CAAC,MAAM;IACd,MAAMgB,UAAU,GAAG,MAAAA,CAAA,KAAY;MAC7B,IAAI,CAACL,IAAI,EAAE;QACTI,aAAa,CAAC,KAAK,CAAC;QACpB;MACF;MAEA,IAAI;QACF,MAAMX,QAAQ,CAACa,WAAW,CAAC,CAAC;QAC5BF,aAAa,CAAC,IAAI,CAAC;MACrB,CAAC,CAAC,OAAOG,GAAG,EAAE;QACZ;QACAL,MAAM,CAAC,CAAC;QACRE,aAAa,CAAC,KAAK,CAAC;MACtB;IACF,CAAC;IAEDC,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,CAACL,IAAI,EAAEE,MAAM,CAAC,CAAC;EAElB,IAAID,OAAO,IAAIE,UAAU,KAAK,IAAI,EAAE;IAClC,oBAAOR,OAAA;MAAKa,SAAS,EAAC,SAAS;MAAAX,QAAA,EAAC;IAAmB;MAAAY,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EAC3D;EAEA,IAAI,CAACT,UAAU,IAAI,CAACH,IAAI,EAAE;IACxB,oBAAOL,OAAA,CAACJ,QAAQ;MAACsB,EAAE,EAAC;IAAQ;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACjC;EAEA,IAAId,YAAY,IAAIE,IAAI,CAACc,IAAI,KAAKhB,YAAY,EAAE;IAC9C,oBAAOH,OAAA,CAACJ,QAAQ;MAACsB,EAAE,EAAC;IAAG;MAAAJ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAC5B;EAEA,OAAOf,QAAQ;AACjB,CAAC;AAACE,EAAA,CArCIH,cAAc;AAAAmB,EAAA,GAAdnB,cAAc;AAuCpB,eAAeA,cAAc;AAAC,IAAAmB,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}