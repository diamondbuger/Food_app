{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useContext } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport { apiCalls } from '../services/api';\nexport const useCheckAuth = () => {\n  _s();\n  const {\n    user,\n    logout\n  } = useContext(AuthContext);\n  const location = useLocation();\n\n  // Check token on route change\n  useEffect(() => {\n    const verifyToken = async () => {\n      if (!user) return;\n      try {\n        await apiCalls.verifyToken();\n      } catch (err) {\n        console.log('Token verification failed');\n        logout();\n      }\n    };\n    verifyToken();\n  }, [location.pathname, user, logout]);\n\n  // Check token periodically\n  useEffect(() => {\n    if (!user) return;\n    const interval = setInterval(async () => {\n      try {\n        await apiCalls.verifyToken();\n      } catch (err) {\n        console.log('Periodic token check failed');\n        logout();\n      }\n    }, 5000); // Check every 5 seconds\n\n    return () => clearInterval(interval);\n  }, [user, logout]);\n};\n_s(useCheckAuth, \"fGjP/5oeUxr+pQczRrjMGz2PI/w=\", false, function () {\n  return [useLocation];\n});","map":{"version":3,"names":["useEffect","useContext","useLocation","AuthContext","apiCalls","useCheckAuth","_s","user","logout","location","verifyToken","err","console","log","pathname","interval","setInterval","clearInterval"],"sources":["C:/Users/mitta/.vscode/MERN-FoodApp/src/hooks/useCheckAuth.js"],"sourcesContent":["import { useEffect, useContext } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { apiCalls } from '../services/api';\r\n\r\nexport const useCheckAuth = () => {\r\n  const { user, logout } = useContext(AuthContext);\r\n  const location = useLocation();\r\n\r\n  // Check token on route change\r\n  useEffect(() => {\r\n    const verifyToken = async () => {\r\n      if (!user) return;\r\n\r\n      try {\r\n        await apiCalls.verifyToken();\r\n      } catch (err) {\r\n        console.log('Token verification failed');\r\n        logout();\r\n      }\r\n    };\r\n\r\n    verifyToken();\r\n  }, [location.pathname, user, logout]);\r\n\r\n  // Check token periodically\r\n  useEffect(() => {\r\n    if (!user) return;\r\n\r\n    const interval = setInterval(async () => {\r\n      try {\r\n        await apiCalls.verifyToken();\r\n      } catch (err) {\r\n        console.log('Periodic token check failed');\r\n        logout();\r\n      }\r\n    }, 5000); // Check every 5 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [user, logout]);\r\n};\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAC7C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,WAAW,QAAQ,wBAAwB;AACpD,SAASC,QAAQ,QAAQ,iBAAiB;AAE1C,OAAO,MAAMC,YAAY,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAChC,MAAM;IAAEC,IAAI;IAAEC;EAAO,CAAC,GAAGP,UAAU,CAACE,WAAW,CAAC;EAChD,MAAMM,QAAQ,GAAGP,WAAW,CAAC,CAAC;;EAE9B;EACAF,SAAS,CAAC,MAAM;IACd,MAAMU,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAI,CAACH,IAAI,EAAE;MAEX,IAAI;QACF,MAAMH,QAAQ,CAACM,WAAW,CAAC,CAAC;MAC9B,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAACC,GAAG,CAAC,2BAA2B,CAAC;QACxCL,MAAM,CAAC,CAAC;MACV;IACF,CAAC;IAEDE,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,CAACD,QAAQ,CAACK,QAAQ,EAAEP,IAAI,EAAEC,MAAM,CAAC,CAAC;;EAErC;EACAR,SAAS,CAAC,MAAM;IACd,IAAI,CAACO,IAAI,EAAE;IAEX,MAAMQ,QAAQ,GAAGC,WAAW,CAAC,YAAY;MACvC,IAAI;QACF,MAAMZ,QAAQ,CAACM,WAAW,CAAC,CAAC;MAC9B,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZC,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;QAC1CL,MAAM,CAAC,CAAC;MACV;IACF,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;;IAEV,OAAO,MAAMS,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,CAACR,IAAI,EAAEC,MAAM,CAAC,CAAC;AACpB,CAAC;AAACF,EAAA,CAnCWD,YAAY;EAAA,QAENH,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}