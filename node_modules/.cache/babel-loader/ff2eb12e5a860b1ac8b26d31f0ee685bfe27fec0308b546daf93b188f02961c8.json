{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useContext } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { AuthContext } from '../context/AuthContext';\nimport { apiCalls } from '../services/api';\nexport const useCheckAuth = () => {\n  _s();\n  const {\n    user,\n    logout\n  } = useContext(AuthContext);\n  const location = useLocation();\n  useEffect(() => {\n    const verifyToken = async () => {\n      // Only verify if user is logged in\n      if (user) {\n        try {\n          await apiCalls.verifyToken();\n        } catch (err) {\n          // Token is invalid or cookie was deleted\n          console.log('Token verification failed, logging out');\n          logout();\n        }\n      }\n    };\n\n    // Verify token when route changes\n    verifyToken();\n  }, [location, user, logout]);\n\n  // Also check periodically\n  useEffect(() => {\n    if (!user) return;\n    const interval = setInterval(async () => {\n      try {\n        await apiCalls.verifyToken();\n      } catch (err) {\n        logout();\n      }\n    }, 10000); // Check every 10 seconds\n\n    return () => clearInterval(interval);\n  }, [user, logout]);\n};\n_s(useCheckAuth, \"fGjP/5oeUxr+pQczRrjMGz2PI/w=\", false, function () {\n  return [useLocation];\n});","map":{"version":3,"names":["useEffect","useContext","useLocation","AuthContext","apiCalls","useCheckAuth","_s","user","logout","location","verifyToken","err","console","log","interval","setInterval","clearInterval"],"sources":["C:/Users/mitta/.vscode/MERN-FoodApp/src/hooks/useCheckAuth.js"],"sourcesContent":["import { useEffect, useContext } from 'react';\r\nimport { useLocation } from 'react-router-dom';\r\nimport { AuthContext } from '../context/AuthContext';\r\nimport { apiCalls } from '../services/api';\r\n\r\nexport const useCheckAuth = () => {\r\n  const { user, logout } = useContext(AuthContext);\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    const verifyToken = async () => {\r\n      // Only verify if user is logged in\r\n      if (user) {\r\n        try {\r\n          await apiCalls.verifyToken();\r\n        } catch (err) {\r\n          // Token is invalid or cookie was deleted\r\n          console.log('Token verification failed, logging out');\r\n          logout();\r\n        }\r\n      }\r\n    };\r\n\r\n    // Verify token when route changes\r\n    verifyToken();\r\n  }, [location, user, logout]);\r\n\r\n  // Also check periodically\r\n  useEffect(() => {\r\n    if (!user) return;\r\n\r\n    const interval = setInterval(async () => {\r\n      try {\r\n        await apiCalls.verifyToken();\r\n      } catch (err) {\r\n        logout();\r\n      }\r\n    }, 10000); // Check every 10 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [user, logout]);\r\n};\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAC7C,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,WAAW,QAAQ,wBAAwB;AACpD,SAASC,QAAQ,QAAQ,iBAAiB;AAE1C,OAAO,MAAMC,YAAY,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAChC,MAAM;IAAEC,IAAI;IAAEC;EAAO,CAAC,GAAGP,UAAU,CAACE,WAAW,CAAC;EAChD,MAAMM,QAAQ,GAAGP,WAAW,CAAC,CAAC;EAE9BF,SAAS,CAAC,MAAM;IACd,MAAMU,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B;MACA,IAAIH,IAAI,EAAE;QACR,IAAI;UACF,MAAMH,QAAQ,CAACM,WAAW,CAAC,CAAC;QAC9B,CAAC,CAAC,OAAOC,GAAG,EAAE;UACZ;UACAC,OAAO,CAACC,GAAG,CAAC,wCAAwC,CAAC;UACrDL,MAAM,CAAC,CAAC;QACV;MACF;IACF,CAAC;;IAED;IACAE,WAAW,CAAC,CAAC;EACf,CAAC,EAAE,CAACD,QAAQ,EAAEF,IAAI,EAAEC,MAAM,CAAC,CAAC;;EAE5B;EACAR,SAAS,CAAC,MAAM;IACd,IAAI,CAACO,IAAI,EAAE;IAEX,MAAMO,QAAQ,GAAGC,WAAW,CAAC,YAAY;MACvC,IAAI;QACF,MAAMX,QAAQ,CAACM,WAAW,CAAC,CAAC;MAC9B,CAAC,CAAC,OAAOC,GAAG,EAAE;QACZH,MAAM,CAAC,CAAC;MACV;IACF,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC;;IAEX,OAAO,MAAMQ,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,CAACP,IAAI,EAAEC,MAAM,CAAC,CAAC;AACpB,CAAC;AAACF,EAAA,CApCWD,YAAY;EAAA,QAENH,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}